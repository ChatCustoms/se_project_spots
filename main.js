!function(){"use strict";var e="";const t={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__submit-button",inactiveButtonClass:"modal__submit-button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error"},r=(e,t,r)=>{const o=t.id+"-error";e.querySelector("#"+o).textContent="",t.classList.remove(r.inputErrorClass)},o=(e,t,r)=>{(e=>e.some((e=>!e.validity.valid)))(e)?n(t,r):(t.disabled=!1,t.classList.remove(r.inactiveButtonClass))},n=(e,t)=>{e.disabled=!0,e.classList.add(t.inactiveButtonClass)},a=e=>{document.querySelectorAll(e.formSelector).forEach((t=>{((e,t)=>{const n=Array.from(e.querySelectorAll(t.inputSelector)),a=e.querySelector(t.submitButtonSelector);o(n,a,t),n.forEach((l=>{l.addEventListener("input",(function(){((e,t,o)=>{t.validity.valid?r(e,t,o):((e,t,r,o)=>{const n=t.id+"-error";e.querySelector("#"+n).textContent=r,t.classList.add(o.inputErrorClass)})(e,t,t.validationMessage,o)})(e,l,t),o(n,a,t)}))}))})(t,e)}))};document.addEventListener("DOMContentLoaded",(()=>{a(t)}));var l=e+"images/logo.svg",s=e+"2fc47fd8e9a9bcd9612f.jpg",c=e+"images/pencil.svg",i=e+"images/plus.svg";new class{constructor(e){let{baseUrl:t,headers:r}=e;this._baseUrl=t,this._headers=r}getAppInfo(){return Promise.all([this.getInitialCards(),this.getUserInfo()])}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then((e=>{if(e.ok)return e.json();Promise.reject(`Error: ${e.status}`)}))}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers}).then((e=>{if(e.ok)return e.json();Promise.reject(`Error: ${e.status}`)}))}editUserInfo(e){let{name:t,about:r}=e;return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:t,about:r})}).then((e=>{if(e.ok)return e.json();Promise.reject(`Error: ${e.status}`)}))}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"eaa07941-85e8-4191-b5c0-cf5839401a76","Content-Type":"application/json"}}).getAppInfo().then((e=>{let[t]=e;t.forEach((e=>{const t=U(e);b.prepend(t)}))})).then((e=>{src=e.avatar,m.textContent=e.name,_.textContent=e.about})).catch((e=>{console.log(e)})),document.getElementById("image-logo").src=l,document.getElementById("profile-avatar").src=s,document.getElementById("edit-profile-image").src=c,document.getElementById("plusImage").src=i;const d=document.querySelector(".profile__edit-button"),u=document.querySelector(".profile__add-button"),m=document.querySelector(".profile__name"),_=document.querySelector(".profile__description"),p=document.querySelector("#edit-profile-modal"),v=p.querySelector(".modal__form"),f=p.querySelector(".modal__close-button"),y=p.querySelector("#profile-name-input"),S=p.querySelector("#profile-description-input"),h=document.querySelector("#card-template"),b=document.querySelector(".cards__list"),q=document.querySelector("#add-card-modal"),g=q.querySelector(".modal__form"),E=q.querySelector(".modal__submit-button"),C=q.querySelector(".modal__close-button"),L=q.querySelector("#add-card-name-input"),k=q.querySelector("#add-card-link-input"),I=document.querySelector("#preview-modal"),x=I.querySelector(".modal__image"),B=I.querySelector(".modal__caption");function U(e){const t=h.content.querySelector(".card").cloneNode(!0),r=t.querySelector(".card__title"),o=t.querySelector(".card__image"),n=t.querySelector(".card__like-button"),a=t.querySelector(".card__close-button");return r.textContent=e.name,o.src=e.link,o.alt=e.name,n.addEventListener("click",(()=>{n.classList.toggle("card__like-button_liked")})),o.addEventListener("click",(()=>{$(I),x.src=e.link,B.textContent=e.name,x.alt=e.name})),a.addEventListener("click",(()=>{t.remove()})),t}function j(e){if("Escape"===e.key){const e=document.querySelector(".modal.modal_opened");e&&P(e)}}function A(e){if(!e.target.closest(".modal__content")){const e=document.querySelector(".modal.modal_opened");e&&P(e)}}function $(e){e.classList.add("modal_opened"),document.addEventListener("keydown",j),e.addEventListener("click",A)}function P(e){e.classList.remove("modal_opened"),document.removeEventListener("keydown",j),e.removeEventListener("click",A)}I.querySelector(".modal__close-button").addEventListener("click",(()=>{P(I),console.log(j)})),d.addEventListener("click",(()=>{var e,t;y.value=m.textContent,S.value=_.textContent,e=v,t={inputErrorClass:"modal__input_type_error",errorClass:"modal__error"},[y,S].forEach((o=>{r(e,o,t)})),$(p)})),f.addEventListener("click",(()=>{P(p)})),u.addEventListener("click",(()=>{$(q)})),C.addEventListener("click",(()=>{P(q)})),v.addEventListener("submit",(function(e){e.preventDefault(),m.textContent=y.value,_.textContent=S.value,P(p)})),g.addEventListener("submit",(function(e){e.preventDefault();const r=U({name:L.value,link:k.value});b.prepend(r),n(E,t),e.target.reset(),P(q)})),a(t)}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RCxpQkFBaUIsVUFqQzFCLFNBQTZCa0YsR0FDM0JBLEVBQUlVLGlCQUNKLE1BQ016RCxFQUFjQyxFQURBLENBQUVWLEtBQU11QyxFQUFjMEIsTUFBT2QsS0FBTVgsRUFBY3lCLFFBRXJFdEQsRUFBVUMsUUFBUUgsR0FDbEI5QyxFQUFjMEUsRUFBa0JuRyxHQUNoQ3NILEVBQUlJLE9BQU9PLFFBQ1hULEVBQVd2QixFQUNiLElBcURBckUsRUFBaUI1QixFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy1tYWluL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMtbWFpbi93ZWJwYWNrL3J1bnRpbWUvcHVibGljUGF0aCIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzLW1haW4vLi9zcmMvc2NyaXB0cy92YWxpZGF0aW9uLmpzIiwid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMtbWFpbi8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzLW1haW4vLi9zcmMvdXRpbHMvQXBpLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIFRoZSByZXF1aXJlIHNjb3BlXG52YXIgX193ZWJwYWNrX3JlcXVpcmVfXyA9IHt9O1xuXG4iLCJfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiOyIsImV4cG9ydCBjb25zdCBzZXR0aW5ncyA9IHtcbiAgZm9ybVNlbGVjdG9yOiBcIi5tb2RhbF9fZm9ybVwiLFxuICBpbnB1dFNlbGVjdG9yOiBcIi5tb2RhbF9faW5wdXRcIixcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLm1vZGFsX19zdWJtaXQtYnV0dG9uXCIsXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwibW9kYWxfX3N1Ym1pdC1idXR0b25fZGlzYWJsZWRcIixcbiAgaW5wdXRFcnJvckNsYXNzOiBcIm1vZGFsX19pbnB1dF90eXBlX2Vycm9yXCIsXG4gIGVycm9yQ2xhc3M6IFwibW9kYWxfX2Vycm9yXCIsXG59O1xuXG5jb25zdCBzaG93SW5wdXRFcnJvciA9IChmb3JtRWwsIGlucHV0RWwsIGVycm9yTXNnLCBjb25maWcpID0+IHtcbiAgY29uc3QgZXJyb3JNc2dJRCA9IGlucHV0RWwuaWQgKyBcIi1lcnJvclwiO1xuICBjb25zdCBlcnJvck1zZ0VsID0gZm9ybUVsLnF1ZXJ5U2VsZWN0b3IoXCIjXCIgKyBlcnJvck1zZ0lEKTtcbiAgZXJyb3JNc2dFbC50ZXh0Q29udGVudCA9IGVycm9yTXNnO1xuICBpbnB1dEVsLmNsYXNzTGlzdC5hZGQoY29uZmlnLmlucHV0RXJyb3JDbGFzcyk7XG59O1xuXG5jb25zdCBoaWRlSW5wdXRFcnJvciA9IChmb3JtRWwsIGlucHV0RWwsIGNvbmZpZykgPT4ge1xuICBjb25zdCBlcnJvck1zZ0lEID0gaW5wdXRFbC5pZCArIFwiLWVycm9yXCI7XG4gIGNvbnN0IGVycm9yTXNnRWwgPSBmb3JtRWwucXVlcnlTZWxlY3RvcihcIiNcIiArIGVycm9yTXNnSUQpO1xuICBlcnJvck1zZ0VsLnRleHRDb250ZW50ID0gXCJcIjtcbiAgaW5wdXRFbC5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5pbnB1dEVycm9yQ2xhc3MpO1xufTtcblxuY29uc3QgY2hlY2tJbnB1dFZhbGlkaXR5ID0gKGZvcm1FbCwgaW5wdXRFbCwgY29uZmlnKSA9PiB7XG4gIGlmICghaW5wdXRFbC52YWxpZGl0eS52YWxpZCkge1xuICAgIHNob3dJbnB1dEVycm9yKGZvcm1FbCwgaW5wdXRFbCwgaW5wdXRFbC52YWxpZGF0aW9uTWVzc2FnZSwgY29uZmlnKTtcbiAgfSBlbHNlIHtcbiAgICBoaWRlSW5wdXRFcnJvcihmb3JtRWwsIGlucHV0RWwsIGNvbmZpZyk7XG4gIH1cbn07XG5cbmNvbnN0IGhhc0ludmFsaWRJbnB1dCA9IChpbnB1dExpc3QpID0+IHtcbiAgcmV0dXJuIGlucHV0TGlzdC5zb21lKChpbnB1dCkgPT4gIWlucHV0LnZhbGlkaXR5LnZhbGlkKTtcbn07XG5cbmNvbnN0IHRvZ2dsZUJ1dHRvblN0YXRlID0gKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCwgY29uZmlnKSA9PiB7XG4gIGlmIChoYXNJbnZhbGlkSW5wdXQoaW5wdXRMaXN0KSkge1xuICAgIGRpc2FibGVCdXR0b24oYnV0dG9uRWxlbWVudCwgY29uZmlnKTtcbiAgfSBlbHNlIHtcbiAgICBidXR0b25FbGVtZW50LmRpc2FibGVkID0gZmFsc2U7XG4gICAgYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgfVxufTtcblxuZXhwb3J0IGNvbnN0IGRpc2FibGVCdXR0b24gPSAoYnV0dG9uRWxlbWVudCwgY29uZmlnKSA9PiB7XG4gIGJ1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSB0cnVlO1xuICBidXR0b25FbGVtZW50LmNsYXNzTGlzdC5hZGQoY29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xufTtcblxuZXhwb3J0IGNvbnN0IHJlc2V0VmFsaWRhdGlvbiA9IChmb3JtRWwsIGlucHV0TGlzdCwgY29uZmlnKSA9PiB7XG4gIGlucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgIGhpZGVJbnB1dEVycm9yKGZvcm1FbCwgaW5wdXQsIGNvbmZpZyk7XG4gIH0pO1xufTtcblxuY29uc3Qgc2V0RXZlbnRMaXN0ZW5lcnMgPSAoZm9ybUVsLCBjb25maWcpID0+IHtcbiAgY29uc3QgaW5wdXRMaXN0ID0gQXJyYXkuZnJvbShmb3JtRWwucXVlcnlTZWxlY3RvckFsbChjb25maWcuaW5wdXRTZWxlY3RvcikpO1xuICBjb25zdCBidXR0b25FbGVtZW50ID0gZm9ybUVsLnF1ZXJ5U2VsZWN0b3IoY29uZmlnLnN1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcblxuICB0b2dnbGVCdXR0b25TdGF0ZShpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQsIGNvbmZpZyk7XG5cbiAgaW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xuICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgY2hlY2tJbnB1dFZhbGlkaXR5KGZvcm1FbCwgaW5wdXRFbGVtZW50LCBjb25maWcpO1xuICAgICAgdG9nZ2xlQnV0dG9uU3RhdGUoaW5wdXRMaXN0LCBidXR0b25FbGVtZW50LCBjb25maWcpO1xuICAgIH0pO1xuICB9KTtcbn07XG5cbmV4cG9ydCBjb25zdCBlbmFibGVWYWxpZGF0aW9uID0gKGNvbmZpZykgPT4ge1xuICBjb25zdCBmb3JtTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoY29uZmlnLmZvcm1TZWxlY3Rvcik7XG4gIGZvcm1MaXN0LmZvckVhY2goKGZvcm1FbCkgPT4ge1xuICAgIHNldEV2ZW50TGlzdGVuZXJzKGZvcm1FbCwgY29uZmlnKTtcbiAgfSk7XG59O1xuXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiRE9NQ29udGVudExvYWRlZFwiLCAoKSA9PiB7XG4gIGVuYWJsZVZhbGlkYXRpb24oc2V0dGluZ3MpO1xufSk7XG4iLCJpbXBvcnQge1xuICBlbmFibGVWYWxpZGF0aW9uLFxuICBzZXR0aW5ncyxcbiAgZGlzYWJsZUJ1dHRvbixcbiAgcmVzZXRWYWxpZGF0aW9uLFxufSBmcm9tIFwiLi4vc2NyaXB0cy92YWxpZGF0aW9uLmpzXCI7XG5pbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xuaW1wb3J0IGxvZ29TUkMgZnJvbSBcIi4uL2ltYWdlcy9sb2dvLnN2Z1wiO1xuaW1wb3J0IGF2YXRhclNSQyBmcm9tIFwiLi4vaW1hZ2VzL3Nwb3RzLWF2YXRhci1hbmQtY2FyZC1pbWFnZXMvYXZhdGFyLmpwZ1wiO1xuaW1wb3J0IHByb2ZpbGVJbWFnZVNyYyBmcm9tIFwiLi4vaW1hZ2VzL3BlbmNpbC5zdmdcIjtcbmltcG9ydCBwbHVzSW1hZ2VTUkMgZnJvbSBcIi4uL2ltYWdlcy9wbHVzLnN2Z1wiO1xuaW1wb3J0IEFQSSBmcm9tIFwiLi4vdXRpbHMvQXBpLmpzXCI7XG5cbi8vIGNvbnN0IGluaXRpYWxDYXJkcyA9IFtcbi8vICAge1xuLy8gICAgIG5hbWU6IFwiVmFsIFRob3JlbnNcIixcbi8vICAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvMS1waG90by1ieS1tb3JpdHotZmVsZG1hbm4tZnJvbS1wZXhlbHMuanBnXCIsXG4vLyAgIH0sXG4vLyAgIHtcbi8vICAgICBuYW1lOiBcIlJlc3R1cmFudCBUZXJyYWNlXCIsXG4vLyAgICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL3Nwb3RzLzItcGhvdG8tYnktY2VpbGluZS1mcm9tLXBleGVscy5qcGdcIixcbi8vICAgfSxcbi8vICAge1xuLy8gICAgIG5hbWU6IFwiQW4gb3V0ZG9vciBjYWZlXCIsXG4vLyAgICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL3Nwb3RzLzMtcGhvdG8tYnktdHViYW51ci1kb2dhbi1mcm9tLXBleGVscy5qcGdcIixcbi8vICAgfSxcbi8vICAge1xuLy8gICAgIG5hbWU6IFwiQSB2ZXJ5IGxvbmcgYnJpZGdlLCBvdmVyIHRoZSBmb3Jlc3QgYW5kIHRocm91Z2ggdGhlIHRyZWVzXCIsXG4vLyAgICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL3Nwb3RzLzQtcGhvdG8tYnktbWF1cmljZS1sYXNjaGV0LWZyb20tcGV4ZWxzLmpwZ1wiLFxuLy8gICB9LFxuLy8gICB7XG4vLyAgICAgbmFtZTogXCJUdW5uZWwgd2l0aCBtb3JuaW5nIGxpZ2h0XCIsXG4vLyAgICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL3Nwb3RzLzUtcGhvdG8tYnktdmFuLWFuaC1uZ3V5ZW4tZnJvbS1wZXhlbHMuanBnXCIsXG4vLyAgIH0sXG4vLyAgIHtcbi8vICAgICBuYW1lOiBcIk1vdW50YWluIGhvdXNlXCIsXG4vLyAgICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL3Nwb3RzLzYtcGhvdG8tYnktbW9yaXR6LWZlbGRtYW5uLWZyb20tcGV4ZWxzLmpwZ1wiLFxuLy8gICB9LFxuLy8gXTtcblxuY29uc3QgYXBpID0gbmV3IEFQSSh7XG4gIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQtYXBpLmVuLnRyaXBsZXRlbi1zZXJ2aWNlcy5jb20vdjFcIixcbiAgaGVhZGVyczoge1xuICAgIGF1dGhvcml6YXRpb246IFwiZWFhMDc5NDEtODVlOC00MTkxLWI1YzAtY2Y1ODM5NDAxYTc2XCIsXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gIH0sXG59KTtcblxuYXBpXG4gIC5nZXRBcHBJbmZvKClcbiAgLnRoZW4oKFtjYXJkc10pID0+IHtcbiAgICBjYXJkcy5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgICBjb25zdCBjYXJkRWxlbWVudCA9IGdldENhcmRFbGVtZW50KGl0ZW0pO1xuICAgICAgY2FyZHNMaXN0LnByZXBlbmQoY2FyZEVsZW1lbnQpO1xuICAgIH0pO1xuICB9KVxuICAudGhlbigodXNlcnMpID0+IHtcbiAgICBzcmMgPSB1c2Vycy5hdmF0YXI7XG4gICAgcHJvZmlsZU5hbWUudGV4dENvbnRlbnQgPSB1c2Vycy5uYW1lO1xuICAgIHByb2ZpbGVEZXNjcmlwdGlvbi50ZXh0Q29udGVudCA9IHVzZXJzLmFib3V0O1xuICB9KVxuICAuY2F0Y2goKGVycikgPT4ge1xuICAgIGNvbnNvbGUubG9nKGVycik7XG4gIH0pO1xuXG5jb25zdCBsb2dvSW1hZ2UgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImltYWdlLWxvZ29cIik7XG5sb2dvSW1hZ2Uuc3JjID0gbG9nb1NSQztcblxuY29uc3QgcHJvZmlsZUF2YXRhciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicHJvZmlsZS1hdmF0YXJcIik7XG5wcm9maWxlQXZhdGFyLnNyYyA9IGF2YXRhclNSQztcblxuY29uc3QgcHJvZmlsZUltYWdlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJlZGl0LXByb2ZpbGUtaW1hZ2VcIik7XG5wcm9maWxlSW1hZ2Uuc3JjID0gcHJvZmlsZUltYWdlU3JjO1xuXG5jb25zdCBwbHVzSW1hZ2UgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInBsdXNJbWFnZVwiKTtcbnBsdXNJbWFnZS5zcmMgPSBwbHVzSW1hZ2VTUkM7XG5cbmNvbnN0IHByb2ZpbGVFZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19lZGl0LWJ1dHRvblwiKTtcbmNvbnN0IGNhcmRNb2RhbEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYWRkLWJ1dHRvblwiKTtcbmNvbnN0IHByb2ZpbGVOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19uYW1lXCIpO1xuY29uc3QgcHJvZmlsZURlc2NyaXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiKTtcblxuY29uc3QgZWRpdFByb2ZpbGVNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZWRpdC1wcm9maWxlLW1vZGFsXCIpO1xuY29uc3QgZWRpdEZvcm1FbGVtZW50ID0gZWRpdFByb2ZpbGVNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xuY29uc3QgZWRpdFByb2ZpbGVDbG9zZUJ1dHRvbiA9IGVkaXRQcm9maWxlTW9kYWwucXVlcnlTZWxlY3RvcihcbiAgXCIubW9kYWxfX2Nsb3NlLWJ1dHRvblwiXG4pO1xuY29uc3QgZWRpdE1vZGFsTmFtZUlucHV0ID0gZWRpdFByb2ZpbGVNb2RhbC5xdWVyeVNlbGVjdG9yKFxuICBcIiNwcm9maWxlLW5hbWUtaW5wdXRcIlxuKTtcbmNvbnN0IGVkaXRNb2RhbERlc2NyaXB0aW9uSW5wdXQgPSBlZGl0UHJvZmlsZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoXG4gIFwiI3Byb2ZpbGUtZGVzY3JpcHRpb24taW5wdXRcIlxuKTtcbmNvbnN0IGNhcmRUZW1wbGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZC10ZW1wbGF0ZVwiKTtcbmNvbnN0IGNhcmRzTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZHNfX2xpc3RcIik7XG5cbmNvbnN0IGNhcmRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYWRkLWNhcmQtbW9kYWxcIik7XG5jb25zdCBjYXJkRm9ybSA9IGNhcmRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xuY29uc3QgY2FyZFN1Ym1pdEJ1dHRvbiA9IGNhcmRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19zdWJtaXQtYnV0dG9uXCIpO1xuY29uc3QgY2FyZE1vZGFsQ2xvc2VCdXR0b24gPSBjYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2UtYnV0dG9uXCIpO1xuY29uc3QgY2FyZE5hbWVJbnB1dCA9IGNhcmRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiI2FkZC1jYXJkLW5hbWUtaW5wdXRcIik7XG5jb25zdCBjYXJkTGlua0lucHV0ID0gY2FyZE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjYWRkLWNhcmQtbGluay1pbnB1dFwiKTtcblxuY29uc3QgcHJldmlld01vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcmV2aWV3LW1vZGFsXCIpO1xuY29uc3QgcHJldmlld01vZGFsSW1hZ2VFbCA9IHByZXZpZXdNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19pbWFnZVwiKTtcbmNvbnN0IHByZXZpZXdNb2RhbENhcHRpb25FbCA9IHByZXZpZXdNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jYXB0aW9uXCIpO1xuY29uc3QgcHJldmlld01vZGFsQ2xvc2UgPSBwcmV2aWV3TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2UtYnV0dG9uXCIpO1xuXG5mdW5jdGlvbiBnZXRDYXJkRWxlbWVudChkYXRhKSB7XG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gY2FyZFRlbXBsYXRlLmNvbnRlbnRcbiAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkXCIpXG4gICAgLmNsb25lTm9kZSh0cnVlKTtcblxuICBjb25zdCBjYXJkTmFtZUVsID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX190aXRsZVwiKTtcbiAgY29uc3QgY2FyZEltYWdlID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTtcbiAgY29uc3QgY2FyZExpa2VCdXR0b24gPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpO1xuICBjb25zdCBjYXJkQ2xvc2VCdXR0b24gPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2Nsb3NlLWJ1dHRvblwiKTtcblxuICBjYXJkTmFtZUVsLnRleHRDb250ZW50ID0gZGF0YS5uYW1lO1xuICBjYXJkSW1hZ2Uuc3JjID0gZGF0YS5saW5rO1xuICBjYXJkSW1hZ2UuYWx0ID0gZGF0YS5uYW1lO1xuXG4gIGNhcmRMaWtlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgY2FyZExpa2VCdXR0b24uY2xhc3NMaXN0LnRvZ2dsZShcImNhcmRfX2xpa2UtYnV0dG9uX2xpa2VkXCIpO1xuICB9KTtcblxuICBjYXJkSW1hZ2UuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICBvcGVuTW9kYWwocHJldmlld01vZGFsKTtcbiAgICBwcmV2aWV3TW9kYWxJbWFnZUVsLnNyYyA9IGRhdGEubGluaztcbiAgICBwcmV2aWV3TW9kYWxDYXB0aW9uRWwudGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XG4gICAgcHJldmlld01vZGFsSW1hZ2VFbC5hbHQgPSBkYXRhLm5hbWU7XG4gIH0pO1xuXG4gIGNhcmRDbG9zZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgIC8vIGNhcmRDbG9zZUJ1dHRvbi5jbG9zZXN0KFwiLmNhcmRcIikucmVtb3ZlKCk7XG4gICAgY2FyZEVsZW1lbnQucmVtb3ZlKCk7XG4gIH0pO1xuXG4gIHJldHVybiBjYXJkRWxlbWVudDtcbn1cblxucHJldmlld01vZGFsQ2xvc2UuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgY2xvc2VNb2RhbChwcmV2aWV3TW9kYWwpO1xuICBjb25zb2xlLmxvZyhoYW5kbGVFc2NhcGUpO1xufSk7XG5cbmZ1bmN0aW9uIGhhbmRlbEVkaXRGb3JtU3VibWl0KGV2dCkge1xuICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgcHJvZmlsZU5hbWUudGV4dENvbnRlbnQgPSBlZGl0TW9kYWxOYW1lSW5wdXQudmFsdWU7XG4gIHByb2ZpbGVEZXNjcmlwdGlvbi50ZXh0Q29udGVudCA9IGVkaXRNb2RhbERlc2NyaXB0aW9uSW5wdXQudmFsdWU7XG4gIGNsb3NlTW9kYWwoZWRpdFByb2ZpbGVNb2RhbCk7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZUFkZENhcmRTdWJtaXQoZXZ0KSB7XG4gIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICBjb25zdCBpbnB1dFZhbHVlcyA9IHsgbmFtZTogY2FyZE5hbWVJbnB1dC52YWx1ZSwgbGluazogY2FyZExpbmtJbnB1dC52YWx1ZSB9O1xuICBjb25zdCBjYXJkRWxlbWVudCA9IGdldENhcmRFbGVtZW50KGlucHV0VmFsdWVzKTtcbiAgY2FyZHNMaXN0LnByZXBlbmQoY2FyZEVsZW1lbnQpO1xuICBkaXNhYmxlQnV0dG9uKGNhcmRTdWJtaXRCdXR0b24sIHNldHRpbmdzKTtcbiAgZXZ0LnRhcmdldC5yZXNldCgpO1xuICBjbG9zZU1vZGFsKGNhcmRNb2RhbCk7XG59XG5cbnByb2ZpbGVFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGVkaXRNb2RhbE5hbWVJbnB1dC52YWx1ZSA9IHByb2ZpbGVOYW1lLnRleHRDb250ZW50O1xuICBlZGl0TW9kYWxEZXNjcmlwdGlvbklucHV0LnZhbHVlID0gcHJvZmlsZURlc2NyaXB0aW9uLnRleHRDb250ZW50O1xuICByZXNldFZhbGlkYXRpb24oXG4gICAgZWRpdEZvcm1FbGVtZW50LFxuICAgIFtlZGl0TW9kYWxOYW1lSW5wdXQsIGVkaXRNb2RhbERlc2NyaXB0aW9uSW5wdXRdLFxuICAgIHtcbiAgICAgIGlucHV0RXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXRfdHlwZV9lcnJvclwiLFxuICAgICAgZXJyb3JDbGFzczogXCJtb2RhbF9fZXJyb3JcIixcbiAgICB9XG4gICk7XG4gIG9wZW5Nb2RhbChlZGl0UHJvZmlsZU1vZGFsKTtcbn0pO1xuZWRpdFByb2ZpbGVDbG9zZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBjbG9zZU1vZGFsKGVkaXRQcm9maWxlTW9kYWwpO1xufSk7XG5jYXJkTW9kYWxCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgb3Blbk1vZGFsKGNhcmRNb2RhbCk7XG59KTtcbmNhcmRNb2RhbENsb3NlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGNsb3NlTW9kYWwoY2FyZE1vZGFsKTtcbn0pO1xuZWRpdEZvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgaGFuZGVsRWRpdEZvcm1TdWJtaXQpO1xuY2FyZEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBoYW5kbGVBZGRDYXJkU3VibWl0KTtcblxuZnVuY3Rpb24gaGFuZGxlRXNjYXBlKGV2dCkge1xuICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xuICAgIGNvbnN0IG9wZW5Nb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWwubW9kYWxfb3BlbmVkXCIpO1xuICAgIGlmIChvcGVuTW9kYWwpIGNsb3NlTW9kYWwob3Blbk1vZGFsKTtcbiAgfVxufVxuXG5mdW5jdGlvbiBoYW5kbGVPdmVybGF5Q2xpY2soZXZ0KSB7XG4gIGlmICghZXZ0LnRhcmdldC5jbG9zZXN0KFwiLm1vZGFsX19jb250ZW50XCIpKSB7XG4gICAgY29uc3Qgb3Blbk1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbC5tb2RhbF9vcGVuZWRcIik7XG4gICAgaWYgKG9wZW5Nb2RhbCkgY2xvc2VNb2RhbChvcGVuTW9kYWwpO1xuICB9XG59XG5cbmZ1bmN0aW9uIG9wZW5Nb2RhbChtb2RhbCkge1xuICBtb2RhbC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfb3BlbmVkXCIpO1xuICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBoYW5kbGVFc2NhcGUpO1xuICBtb2RhbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgaGFuZGxlT3ZlcmxheUNsaWNrKTtcbn1cblxuZnVuY3Rpb24gY2xvc2VNb2RhbChtb2RhbCkge1xuICBtb2RhbC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfb3BlbmVkXCIpO1xuICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBoYW5kbGVFc2NhcGUpO1xuICBtb2RhbC5yZW1vdmVFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgaGFuZGxlT3ZlcmxheUNsaWNrKTtcbn1cblxuZW5hYmxlVmFsaWRhdGlvbihzZXR0aW5ncyk7XG4iLCIvLyBjb25zdCB7IGdldCB9ID0gcmVxdWlyZShcImNvcmUtanMvY29yZS9kaWN0XCIpO1xuXG5jbGFzcyBBUEkge1xuICAgIGNvbnN0cnVjdG9yKHsgYmFzZVVybCwgaGVhZGVycyB9KSB7XG4gICAgICB0aGlzLl9iYXNlVXJsID0gYmFzZVVybDtcbiAgICAgIHRoaXMuX2hlYWRlcnMgPSBoZWFkZXJzO1xufVxuXG5nZXRBcHBJbmZvKCkge1xuICAgIHJldHVybiBQcm9taXNlLmFsbChbdGhpcy5nZXRJbml0aWFsQ2FyZHMoKSwgdGhpcy5nZXRVc2VySW5mbygpXSk7XG59XG5cbmdldEluaXRpYWxDYXJkcygpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XG4gICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnNcbiAgICAgIH0pXG4gICAgICAgIC50aGVuKHJlcyA9PiB7XG4gICAgICAgICAgaWYgKHJlcy5vaykge1xuICAgICAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG59XG5Qcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcbn0pO1xufVxuZ2V0VXNlckluZm8oKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xuICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzXG4gICAgICB9KVxuICAgICAgICAudGhlbihyZXMgPT4ge1xuICAgICAgICAgIGlmIChyZXMub2spIHtcbiAgICAgICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgICAgIH1cbiAgICAgICAgICAgIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgICAgICB9KVxuICAgICAgfVxuXG5lZGl0VXNlckluZm8oeyBuYW1lLCBhYm91dCB9KSBcbntcbiAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xuICAgIG1ldGhvZDogXCJQQVRDSFwiLFxuICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgbmFtZSxcbiAgICAgIGFib3V0LFxuICAgIH0pLFxuICB9KS50aGVuKChyZXMpID0+IHtcbiAgICBpZiAocmVzLm9rKSB7XG4gICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICB9XG4gICAgICBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcbiAgICAgIH0pO1xufVxufVxuXG5cbmV4cG9ydCBkZWZhdWx0IEFQSTsiXSwibmFtZXMiOlsiX193ZWJwYWNrX3JlcXVpcmVfXyIsInNldHRpbmdzIiwiZm9ybVNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJoaWRlSW5wdXRFcnJvciIsImZvcm1FbCIsImlucHV0RWwiLCJjb25maWciLCJlcnJvck1zZ0lEIiwiaWQiLCJxdWVyeVNlbGVjdG9yIiwidGV4dENvbnRlbnQiLCJjbGFzc0xpc3QiLCJyZW1vdmUiLCJ0b2dnbGVCdXR0b25TdGF0ZSIsImlucHV0TGlzdCIsImJ1dHRvbkVsZW1lbnQiLCJzb21lIiwiaW5wdXQiLCJ2YWxpZGl0eSIsInZhbGlkIiwiaGFzSW52YWxpZElucHV0IiwiZGlzYWJsZUJ1dHRvbiIsImRpc2FibGVkIiwiYWRkIiwiZW5hYmxlVmFsaWRhdGlvbiIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvckFsbCIsImZvckVhY2giLCJzZXRFdmVudExpc3RlbmVycyIsIkFycmF5IiwiZnJvbSIsImlucHV0RWxlbWVudCIsImFkZEV2ZW50TGlzdGVuZXIiLCJjaGVja0lucHV0VmFsaWRpdHkiLCJzaG93SW5wdXRFcnJvciIsImVycm9yTXNnIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJjb25zdHJ1Y3RvciIsIl9yZWYiLCJiYXNlVXJsIiwiaGVhZGVycyIsInRoaXMiLCJfYmFzZVVybCIsIl9oZWFkZXJzIiwiZ2V0QXBwSW5mbyIsIlByb21pc2UiLCJhbGwiLCJnZXRJbml0aWFsQ2FyZHMiLCJnZXRVc2VySW5mbyIsImZldGNoIiwidGhlbiIsInJlcyIsIm9rIiwianNvbiIsInJlamVjdCIsInN0YXR1cyIsImVkaXRVc2VySW5mbyIsIl9yZWYyIiwibmFtZSIsImFib3V0IiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJhdXRob3JpemF0aW9uIiwiY2FyZHMiLCJpdGVtIiwiY2FyZEVsZW1lbnQiLCJnZXRDYXJkRWxlbWVudCIsImNhcmRzTGlzdCIsInByZXBlbmQiLCJ1c2VycyIsInNyYyIsImF2YXRhciIsInByb2ZpbGVOYW1lIiwicHJvZmlsZURlc2NyaXB0aW9uIiwiY2F0Y2giLCJlcnIiLCJjb25zb2xlIiwibG9nIiwiZ2V0RWxlbWVudEJ5SWQiLCJsb2dvU1JDIiwiYXZhdGFyU1JDIiwicHJvZmlsZUltYWdlU3JjIiwicGx1c0ltYWdlU1JDIiwicHJvZmlsZUVkaXRCdXR0b24iLCJjYXJkTW9kYWxCdXR0b24iLCJlZGl0UHJvZmlsZU1vZGFsIiwiZWRpdEZvcm1FbGVtZW50IiwiZWRpdFByb2ZpbGVDbG9zZUJ1dHRvbiIsImVkaXRNb2RhbE5hbWVJbnB1dCIsImVkaXRNb2RhbERlc2NyaXB0aW9uSW5wdXQiLCJjYXJkVGVtcGxhdGUiLCJjYXJkTW9kYWwiLCJjYXJkRm9ybSIsImNhcmRTdWJtaXRCdXR0b24iLCJjYXJkTW9kYWxDbG9zZUJ1dHRvbiIsImNhcmROYW1lSW5wdXQiLCJjYXJkTGlua0lucHV0IiwicHJldmlld01vZGFsIiwicHJldmlld01vZGFsSW1hZ2VFbCIsInByZXZpZXdNb2RhbENhcHRpb25FbCIsImRhdGEiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiY2FyZE5hbWVFbCIsImNhcmRJbWFnZSIsImNhcmRMaWtlQnV0dG9uIiwiY2FyZENsb3NlQnV0dG9uIiwibGluayIsImFsdCIsInRvZ2dsZSIsIm9wZW5Nb2RhbCIsImhhbmRsZUVzY2FwZSIsImV2dCIsImtleSIsImNsb3NlTW9kYWwiLCJoYW5kbGVPdmVybGF5Q2xpY2siLCJ0YXJnZXQiLCJjbG9zZXN0IiwibW9kYWwiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwicmVzZXRWYWxpZGF0aW9uIiwidmFsdWUiLCJwcmV2ZW50RGVmYXVsdCIsInJlc2V0Il0sInNvdXJjZVJvb3QiOiIifQ==